MODULE SZONEDZONE 
REAL::XYUC
REAL,ALLOCATABLE :: VBARG(:,:),PWATTSN(:),PWATTSG(:)
PRIVATE :: ALLOCATE_STATUS

CONTAINS

SUBROUTINE SZONEDZONE_INIT
USE OCN_PARA_SZONE,ONLY:J0_SZONE => J0, K1_SZONE => K1
USE OCN_PARA_DZONE,ONLY:J0_DZONE => J0
integer :: istat
ALLOCATE(VBARG(J0_SZONE,K1_SZONE),STAT=istat)
CALL ALLOCATE_STATUS(istat)
ALLOCATE(PWATTSN(J0_SZONE),STAT=istat)
CALL ALLOCATE_STATUS(istat)
ALLOCATE(PWATTSG(J0_DZONE),STAT=istat)
CALL ALLOCATE_STATUS(istat)
if (allocated(VBARG)) then
  deallocate(VBARG,STAT=status(1));deallocate(PWATTSN,STAT=status(1));deallocate(PWATTSG,STAT=status(1))
endif
END SUBROUTINE SZONEDZONE_INIT

SUBROUTINE ALLOCATE_STATUS(istat)
INTEGER :: istat
if (istat/=0) STOP "Cannot allocate memory"
END SUBROUTINE ALLOCATE_STATUS

END MODULE SZONEDZONE 
